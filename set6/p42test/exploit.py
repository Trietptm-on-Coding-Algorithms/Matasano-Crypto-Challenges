from Crypto.Util.number import *
from Crypto.PublicKey import RSA
from Crypto.Hash import *
from Crypto.Signature import PKCS1_v1_5

message = "hi mom"

key = RSA.importKey(open("private.key",'r').read())
h = SHA.new(message)
print "hash: ", h.hexdigest()

padded = PKCS1_v1_5.EMSA_PKCS1_V1_5_ENCODE(h, size(key.n)/8)
print padded.encode("hex")

padded_int = bytes_to_long(padded)
signature = long_to_bytes(pow(padded_int, key.d, key.n))
print "Printing the signature"
print signature.encode("hex")